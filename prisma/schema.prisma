generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Subject {
  code      String     @id
  resources Resource[]
}

model Resource {
  id          String
  subjectCode String
  title       String
  githubPath  String
  sections    Section[]
  subject     Subject   @relation(fields: [subjectCode], references: [code])

  @@id([id, subjectCode]) // This creates the id_subjectCode composite key
}

model Section {
  id          String
  resourceId  String
  subjectCode String
  title       String
  url         String
  checksum    String
  resource    Resource @relation(fields: [resourceId, subjectCode], references: [id, subjectCode])

  @@id([id, resourceId])
}
